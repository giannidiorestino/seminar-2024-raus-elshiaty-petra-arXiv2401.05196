\RequirePackage{etex} 

\documentclass[12pt,a4paper]{amsart}

\usepackage{accents}
\usepackage{cleveref}
\usepackage{fullpage}
\usepackage{graphicx}
\usepackage{macros}
\usepackage{mathtools}
\usepackage{natbib}

\title{Seminar}
\author{Giovanni Pistone}
\date{\today}

\begin{document}

\maketitle

\section{Introduction}

In \citet*{raus|elshiaty|petra:arXiv2401.05196}, the authors suggest using the exponential geometry of exponential families but expressing it in the mixture coordinates. See the classical monograph \citet*{brown:86} for exponential families. About infinite dimensional exponential families, see \citet*{pistone:2013gsi}. The present discusses the same idea and its applications in the language on statistical bundles according to \citet*{chirco|pistone:2022}.

\section{Examples}
\label{sec:examples}

\subsection{Poisson}

The Poisson probability function (PF) is
\begin{equation}
  \label{eq:1}
  p(y,\eta) = \frac{\eta^y}{y!} \euler^{-\eta}, \text{with $y \in \posintegers$ and $\eta \in ]0,+\infty[$},
\end{equation}
that is, the log-PF is
\begin{equation}
  \label{eq:20}
  \log p(y;\eta) = (\log \eta) y - \eta - \log y! \ .
\end{equation}

If we change the $\eta$ parameter to $\theta = \log \eta$, that is, $\theta \in \reals$, then $\euler^\theta = \eta$ and
\begin{equation}
  \label{eq:2}
  p(y;\euler^{\theta}) = \frac{\euler^{\theta y}}{y!} \euler^{-\euler^\theta} = \expof{\theta y - \log y! - \euler\theta} =\expof{\theta y - (\euler^{\theta} - 1)} p(y;1) \ .
\end{equation}

The equation above is an exponential family in the reference $p_1$. The parameter $\theta$ is the natural parameter for the sufficient statistics $u \colon y \to y$. The cumulant function is
\begin{equation}
  \label{eq:3}
  \psi(\theta) = \euler^\theta - 1 \ , \quad \text{with} \quad \text{$\psi'(\theta) = \euler^{\theta} = \eta$ and $\psi''(\theta) = \euler^\theta  = \eta$}.
\end{equation}

In the non-parametric point of view, the \cref{eq:2} is the exponential family $\expmodat V$ generated by the affine space $V = \spanof{u,1}$, $u \colon \posintegers \ni y \mapsto y \in \reals$. It is a sub-model of the maximal exponential family $\maxexpat {p_1}$.

The fibre at $p_\eta$ of the statistical bundle $\expbundleat {V}$ is
\begin{equation}
  \label{eq:5}
    \expfibreat {p_\eta} {V} = \spanof{u - \eta} = \setof{\xi(u-\eta)}{\xi \in \reals} \ .
  \end{equation}
Notice that we distinguish between the model parameters and the coordinates in the fibre as the points are PFs, and the random variables in the fibre are velocities.

The covariance inner product on the fibre at $p_\eta$ is 
\begin{multline}
  \label{eq:8}
  \expfibreat {p_\eta} {V} \times \expfibreat {p_\eta} {V} \ni (\xi_1(u - \eta),\xi_2(u-\eta)) \mapsto \\ \covat {p_\eta}{\xi_1(u - \eta)}{\xi_2(u-\eta)} = \xi_1\xi_2 \expectat {p_\eta} {(u - \eta)^2} = \eta\,\xi_1\xi_2\ .
\end{multline}
Compare with \cref{eq:3}.

See in \citet*{chirco|pistone:2022} the construction of the affine exponential geometry of the open probability simplex via the definition of exponential displacement. In the natural parameter, the exponential displacement of the Poisson exponential family is
\begin{multline}
  \label{eq:6}
  (\theta_1,\theta_2) \mapsto \left(p_{\euler^{\theta_1}},p_{\euler^{\theta_2}}\right) \mapsto S_{p_{\euler^{\theta_1}}}(p_{\euler^{\theta_2}}) = \log \frac {p_{\euler^{\theta_2}}}{p_{\euler^{\theta_1}}} - \expectat {p_{\euler^{\theta_1}}} {\log \frac {p_{\euler^{\theta_2}}}{p_{\euler^{\theta_1}}}} = \\ (\theta_2 - \theta_1) u - (\euler^{\theta_2} - \euler^{\theta_1}) - \expectat {p_{\euler^{\theta_1}}} {(\theta_2 - \theta_1) u - (\euler^{\theta_2} - \euler^{\theta_1})} = \\  (\theta_2-\theta_1) (u - \euler^{\theta_1}) \mapsto \theta_2 - \theta_1 = S_{\theta_1}(\theta_2) \ ,
\end{multline}
while in the expectation parameter, the exponential displacement is
\begin{equation}
  \label{eq:9}
  (\eta_1,\eta_2) \mapsto (p_{\eta_1},p_{\eta_2}) \mapsto S_{p_{\eta_1}}(p_{\eta_2}) = \log \frac {\eta_2}{\eta_1} (u - \eta_1) \mapsto \log \frac {\eta_2}{\eta_1} = S_{\eta_1}(\eta_2) \ .
\end{equation}

Notice that the variance of the displacement in its fibre is a divergence,
\begin{equation}
  \label{eq:22}
  \expectat {p_{\eta_1}} {\left(S_{p_{\eta_1}}(p_{\eta_2})\right)^2} =  \expectat {p_{\eta_1}} {\left(\log \frac {\eta_2}{\eta_1} (u - \eta_1)\right)^2} = \left(\log \frac {\eta_2}{\eta_1}\right)^2 \eta_1 \ .  
\end{equation}

The exponential parallel transport is
\begin{equation}
  \label{eq:10}
  \etransport {p_{\eta_1}} {p_{\eta_2}} \colon \expfibreat {p_{\eta_1}} {V} \ni \xi(u - \eta_1) \mapsto \xi(u - \eta_2) \in \expfibreat {p_{\eta_2}} V \ ,
\end{equation}
that is, is the identity in the $\xi$-coordinates, $\etransport {\eta_1}{\eta_2} \xi = \etransport {\theta_1}{\theta_2} \xi = \xi$.

The parallelogram law for the exponential displacement is 
\begin{equation}
  \label{eq:11}
  S_{p_{\eta_1}}(p_{\eta_2}) + \etransport {p_{\eta_2}}{p_{\eta_1}} S_{p_{\eta_2}}(p_{\eta_3}) = S_{p_{\eta_1}}(p_{\eta_3}) \ ,
\end{equation}
that is,
\begin{equation}
  \label{eq:12}
  \log \frac {\eta_2}{\eta_1}(u - \eta_1) + \log \frac {\eta_3}{\eta_2} \etransport {p_{\eta_2}}{p_{\eta_1}} (u - \eta_2) = \log \frac {\eta_3}{\eta_1}  (u - \eta_1) \ . 
\end{equation}

The velocity of the curve $\eta \mapsto p_\eta$ is
\begin{equation}
  \label{eq:13}
  \derivby \eta \log p_\eta = \derivby \eta (\log \eta u - \eta - \log u!) = \frac 1 \eta u - 1  
\end{equation}
and the velocity of the curve $\theta \mapsto p_{\euler^\theta}$ is 
\begin{equation}
  \label{eq:14}
  \derivby \theta \log p_{\euler^\theta} = \derivby \theta (\theta u - \euler^\theta - \log u!) = \left(\frac 1 {\euler^\theta} u - 1\right) \euler^\theta = u - \euler^\theta \ . 
\end{equation}

The curve $t \mapsto q(t) = p_{\eta(t)}$ is an exponential geodesic with initial velocity $\xi (u - \eta)$ at $\eta(0) = \eta$ if the velocity is constant up to the exponential transport,
\begin{equation}
  \label{eq:15}
  \derivby t \log p_{\eta(t)} = \left(\frac 1 {\eta(t)} u - 1\right) \dot \eta(t) = \frac {u - \eta(t)} {\eta(t)} \dot \eta(t)=  \xi (u - \eta(t)) \ ,  
\end{equation}
that is,
\begin{equation}
  \label{eq:16}
  \frac {\dot \eta(t)} {\eta(t)} = \derivby t \log \eta(t) = \xi \ , \quad  \eta(0) = \eta \ .
\end{equation}

It follows $\log \eta(t) = \log \eta + t \xi$, so that
\begin{equation}
  \label{eq:17}
  \log q(t) = \log \eta(t)u - \eta(t) - u! = (\log \eta + t \xi) u - \euler^{\eta + t \xi} - \log u! \ . 
\end{equation}
The initial conditions are satisfied. Notice that $\theta(t) = \log \eta(t) = \log \eta + t \xi$, that is, $t \mapsto \theta(t)$ is an affine function of $t$.

\subsubsection{Dual parallel transport}
Let us compute the dual of the e-transport. For each $\xi_1(u - \eta_1) \in \expfibreat {p_{\eta_1}} V$ and $\xi_2(u - \eta_2) \in \expfibreat {p_{\eta_2}} V$,
\begin{equation}
  \label{eq:4}
  \scalarat {p_{\eta_2}} {\etransport {p_{\eta_1}}{p_{\eta_2}} \xi_1(u - \eta_1)} {\xi_2(u - \eta_2)} = \xi_1 \xi_2 \expectat {p_{\eta_2}} {(u - \eta_2)^2} =  \eta_2\,\xi_1 \xi_2 \ .
\end{equation}
We look for a $\widehat{\xi}_2$ such that
\begin{equation}
  \label{eq:7}
  \xi_1\xi_2 \eta_2 = \scalarat {p_{\eta_1}} {\xi_1(u - \eta_1)}{\widehat{\xi}_2(u - \eta_1)} = \xi_1 \widehat{\xi}_2 \eta_1 \ ,
\end{equation}
namely, $\widehat{\xi}_2 = \frac {\eta_2}{\eta_1} \xi_2$. In conclusion, the dual (or mixture) transport is
\begin{equation}
  \label{eq:18}
  \mtransport {p_{\eta_2}}{p_{\eta_1}} \colon \xi_2(u - \eta_2) \mapsto \frac {\eta_2}{\eta_1} \xi_2 (u - \eta_1) \ .
\end{equation}

The curve
\begin{equation}
    t \mapsto r(t) = \expof{(\log \eta(t))u - \eta(t) - \log u!}
\end{equation}
is the dual (mixture) geodesic with initial velocity $\xi (u - \eta)$ at $\eta(0) = \eta$ if the velocity is constant up to the mixture transport,
\begin{equation}
  \label{eq:19}
  \derivby t \log p_{\eta(t)} = \left(\frac 1 {\eta(t)} u - 1\right) \dot \eta(t) = \frac {u - \eta(t)} {\eta(t)} \dot \eta(t)=  \frac \eta {\eta(t)}\xi (u - \eta(t)) \ ,  
\end{equation}
so that $\dot \eta(t) = \xi \eta$, hence $\eta(t) = \eta + (\xi \eta) t$. In conclusion, the mixture geodesic is
\begin{equation}
  \label{eq:23}
  \log r(t) = \log (\eta + \xi \eta t)u - (\eta + \xi \eta t) - \log u! \ .
\end{equation}

If the mixture geodesics connects $p_{\eta_1}$ at $t = 0$ to $p_{\eta_2}$ at $t = 1$, it holds
\begin{equation}
  \label{eq:24}
  \log \eta_2 u - \eta _2 - \log u! =  \log (\eta_1 + \xi \eta_1)u - (\eta_1 + \xi \eta_1) - \log u!
\end{equation}
hence
\begin{equation}
  \label{eq:25}
  \log \frac {\eta_2}{\eta_1(1+\xi)} = \eta_2 - \eta_1\xi \ . 
\end{equation}

\subsection{Multivariate Poisson}
\label{sec:multivariate-poisson}

\subsection{Multivariate binomial}
\label{sec:mult-binom}


% \bibliographystyle{amsplain}
\bibliographystyle{plainnat}
\bibliography{tutto}

\end{document}

%%% reftex-default-bibliography: ("./")
%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
